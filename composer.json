{
  "name": "municipio-se/municipio-deployment",
  "license": "MIT",
  "description": "Deployment of the Municipio Platform.",
  "authors": [
    {
      "name": "Sebastian Thulin",
      "email": "sebastian.thulin@helsingborg.se"
    },
    {
      "name": "Joel Bernerman",
      "email": "joel.bernerman@helsingborg.se"
    }
  ],
  "config": {
    "sort-packages": true,
    "allow-plugins": {
      "composer/installers": true,
      "johnpbloch/wordpress-core-installer": true,
      "php-http/discovery": true
    },
    "optimize-autoloader": true
  },
  "minimum-stability": "dev",
  "prefer-stable": true,
  "repositories": [
    {
      "type": "composer",
      "url": "https://packagist.org"
    },
    {
      "type": "composer",
      "url": "https://wpackagist.org"
    }
  ],
  "require": {
    "php": "^8.0.0 || ^8.1.0 || ^8.2.0 || ^8.3.0",
    "composer/installers": "v2.3.0",
    "helsingborg-stad/acf-icon-field": "0.2.46",
    "helsingborg-stad/acf-openstreetmap-field": "0.79.13",
    "helsingborg-stad/active-directory-api-wp-integration": "3.1.6",
    "helsingborg-stad/algolia-index": "3.5.10",
    "helsingborg-stad/algolia-index-js-searchpage-addon": "3.6.12",
    "helsingborg-stad/algolia-index-modularity-addon": "3.1.5",
    "helsingborg-stad/algolia-index-typesense-provider": "1.0.13",
    "helsingborg-stad/api-alarm-integration": "5.0.3",
    "helsingborg-stad/api-event-manager-integration": "3.1.0",
    "helsingborg-stad/api-volunteer-manager-integration": "5.1.3",
    "helsingborg-stad/attachment-revisions": "3.0.11",
    "helsingborg-stad/better-post-ui": "3.1.0",
    "helsingborg-stad/blade": "3.5.1",
    "helsingborg-stad/broken-link-detector": "4.2.26",
    "helsingborg-stad/content-scheduler": "3.1.8",
    "helsingborg-stad/custom-short-links": "3.0.6",
    "helsingborg-stad/customer-feedback": "4.1.19",
    "helsingborg-stad/easy-to-read-alternative": "3.0.8",
    "helsingborg-stad/force-ssl": "3.0.3",
    "helsingborg-stad/gdi-modularity-my-pages-about-me": "2.0.1",
    "helsingborg-stad/job-listings": "4.1.8",
    "helsingborg-stad/like-posts": "3.0.16",
    "helsingborg-stad/lix-calculator": "4.1.3",
    "helsingborg-stad/media-usage": "3.0.8",
    "helsingborg-stad/miniorange-saml-20-single-sign-on": "5.2.4",
    "helsingborg-stad/mod-my-pages": "2.0.1",
    "helsingborg-stad/modularity-contact-banner": "4.0.12",
    "helsingborg-stad/modularity-entryscape": "5.0.12",
    "helsingborg-stad/modularity-form-builder": "4.0.6",
    "helsingborg-stad/modularity-guides": "5.0.4",
    "helsingborg-stad/modularity-json-render": "4.0.2",
    "helsingborg-stad/modularity-local-events": "4.0.2",
    "helsingborg-stad/modularity-open-street-map": "3.0.7",
    "helsingborg-stad/modularity-products": "4.0.4",
    "helsingborg-stad/modularity-recommend": "4.0.4",
    "helsingborg-stad/modularity-sections": "4.0.4",
    "helsingborg-stad/modularity-testimonials": "4.0.4",
    "helsingborg-stad/modularity-timeline": "5.0.4",
    "helsingborg-stad/multi-network-urls": "2.0.0",
    "helsingborg-stad/multisite-role-propagation": "3.0.7",
    "helsingborg-stad/municipio": "6.18.1",
    "helsingborg-stad/redirection-extended": "3.0.6",
    "helsingborg-stad/s3-local-index": "1.1.23",
    "helsingborg-stad/s3-uploads-custom-endpoint": "2.0.0",
    "helsingborg-stad/search-notices": "3.0.4",
    "helsingborg-stad/visit-custom-posttypes-taxonomies": "2.0.7",
    "helsingborg-stad/webhooks-manager": "1.3.0",
    "helsingborg-stad/wp-page-for-post-type": "2.0.4",
    "helsingborg-stad/wp-search-statistics": "1.0.4",
    "helsingborg-stad/wpmu-acf-google-maps-key": "1.0.1",
    "helsingborg-stad/wpmu-correct-file-paths": "1.2.2",
    "helsingborg-stad/wpmu-focus-point": "0.2.6",
    "helsingborg-stad/wpmu-invalidate-login-pagecache": "1.1.1",
    "helsingborg-stad/wpmu-litespeed-common-settings": "2.0.2",
    "helsingborg-stad/wpmu-mu-plugins-url-everywhere": "2.0.3",
    "helsingborg-stad/wpmu-network-admin-url": "2.0.4",
    "helsingborg-stad/wpmu-propagate-miniorange-saml-sso-settings": "0.1.3",
    "helsingborg-stad/wpmu-remove-user-endpoint": "0.2.2",
    "helsingborg-stad/wpmu-security": "1.8.7",
    "humanmade/s3-uploads": "3.0.11",
    "johnpbloch/wordpress": "6.9.0",
    "municipio-se/modularity-noticeboard": "1.1.0",
    "helsingborg/modularity-dynamic-guides": "2.0.7",
    "wpackagist-plugin/autodescription": "5.1.4",
    "wpackagist-plugin/cookies-and-content-security-policy": "2.35",
    "wpackagist-plugin/fakerpress": "0.8.0",
    "wpackagist-plugin/litespeed-cache": "7.7",
    "wpackagist-plugin/network-plugin-auditor": "1.10.1",
    "wpackagist-plugin/nginx-helper": "2.3.5",
    "wpackagist-plugin/pressidium-cookie-consent": "1.9.1",
    "wpackagist-plugin/redirection": "5.6.1",
    "wpackagist-plugin/redis-cache": "2.7.0",
    "wpackagist-plugin/simple-smtp": "1.3.4.1",
    "wpackagist-plugin/simplify-admin-menus": "1.3.2",
    "wpackagist-plugin/stream": "4.1.1",
    "wpackagist-plugin/user-switching": "1.11.1",
    "wpackagist-plugin/username-changer": "3.2.3",
    "wpackagist-plugin/varnish-http-purge": "5.6.4",
    "wpackagist-plugin/worddown": "1.1.2",
    "wpackagist-plugin/wp-multi-network": "3.0.0",
    "wpackagist-plugin/wp-nested-pages": "3.2.13"
  },
  "extra": {
    "path": "/",
    "wordpress-install-dir": "wp",
    "installer-paths": {
      "wp-content/mu-plugins/{$name}": [
        "type:wordpress-muplugin",
        "type:acf-plugin"
      ],
      "wp-content/plugins/{$name}": [
        "type:wordpress-plugin"
      ],
      "wp-content/themes/{$name}": [
        "type:wordpress-theme"
      ]
    },
    "aws/aws-sdk-php": [
      "S3"
    ]
  },
  "scripts": {
    "pre-autoload-dump": "Aws\\Script\\Composer\\Composer::removeUnusedServices",
    "pre-install-cmd": [
      "php composer-local-merge.php pre-install"
    ],
    "post-install-cmd": [
      "php composer-local-merge.php post-install",
      "mkdir -p wp-content/uploads/cache/blade-cache"
    ],
    "pre-update-cmd": [
      "php composer-local-merge.php pre-install"
    ],
    "post-update-cmd": [
      "php composer-local-merge.php post-install",
      "composer dump-autoload -o --working-dir ./wp-content/plugins/s3-uploads/"
    ],
    "update-lockfile": "command -v act >/dev/null 2>&1 || brew install act; act -j composer-update --bind",
    "resolve-conflicts": [
      "git fetch origin",
      "git checkout stage",
      "git merge -X ours --no-edit origin/master || true",
      "git commit --no-edit || true"
    ],
    "pin-all-latest": [
      "bash -c 'set -euo pipefail; composer outdated --direct --format=json --ignore-platform-req=ext-imagick | jq -c \".installed[] | select(.latest != null and .latest != \\\"[none matched]\\\" and (.latest | startswith(\\\"dev-\\\") | not)) | {name:.name, version:.latest}\" | while read -r row; do PKG=$(echo \"$row\" | jq -r .name); VER=$(echo \"$row\" | jq -r .version); CURRENT=$(jq -r --arg p \"$PKG\" \".require[\\$p] // \\\"\\\"\" composer.json); if [ -z \"$CURRENT\" ]; then echo \"Skipping $PKG (not in root composer.json)\"; elif [[ \"$CURRENT\" == dev-* ]]; then echo \"Skipping $PKG (current version is dev)\"; else echo \"Updating $PKG to $VER\"; jq --arg p \"$PKG\" --arg v \"$VER\" \".require[\\$p] = \\$v\" composer.json > composer.json.tmp && mv composer.json.tmp composer.json; fi; done'",
      "composer update --lock --ignore-platform-req=ext-imagick"
    ],
    "dev": [
      ".devcontainer/scripts/setup-dev-package.sh"
    ]
  }
}
